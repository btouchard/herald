# Herald Configuration
# Copy to ~/.config/herald/herald.yaml and adjust values.

server:
  # Herald listens on localhost only â€” use Traefik for external access
  host: "127.0.0.1"
  port: 8420
  # Public URL (used for OAuth redirects and dashboard links)
  public_url: "https://herald.example.com"
  # Log level: debug, info, warn, error
  log_level: "info"
  # Optional log file (in addition to stdout)
  # log_file: "~/.config/herald/herald.log"

auth:
  # OAuth 2.1 for Claude Chat Custom Connector
  client_id: "herald-claude-chat"
  client_secret: "${HERALD_CLIENT_SECRET}"
  admin_password_hash: "${HERALD_ADMIN_PASSWORD_HASH}"
  access_token_ttl: 1h
  refresh_token_ttl: 720h
  # Allowed redirect URIs (exact match, no wildcards)
  redirect_uris:
    - "https://claude.ai/oauth/callback"
    - "https://claude.ai/api/oauth/callback"

  # API tokens for REST API / curl / automation
  # api_tokens:
  #   - name: "local"
  #     token_hash: "${HERALD_API_TOKEN_HASH}"
  #     scope: "*"

database:
  path: "~/.config/herald/herald.db"
  retention_days: 90

execution:
  # Path to the Claude Code CLI binary
  claude_path: "claude"
  # Default task timeout (override per task)
  default_timeout: 30m
  max_timeout: 2h
  # Working directory for temp files (prompts, outputs)
  work_dir: "~/.config/herald/work"
  # Global concurrent task limit
  max_concurrent: 3
  # Maximum prompt size in bytes (protects against OOM)
  max_prompt_size: 102400
  # Maximum output buffer per task in bytes (protects against OOM)
  max_output_size: 1048576
  env:
    CLAUDE_CODE_ENTRYPOINT: "herald"
    CLAUDE_CODE_DISABLE_AUTO_UPDATE: "1"

notifications:
  ntfy:
    enabled: false
    server: "https://ntfy.sh"
    topic: "herald"
    # token: "${HERALD_NTFY_TOKEN}"
    events:
      - "task.completed"
      - "task.failed"

  # webhooks:
  #   - name: "n8n"
  #     url: "https://n8n.example.com/webhook/herald"
  #     secret: "${HERALD_WEBHOOK_SECRET}"
  #     events: ["task.completed", "task.failed"]

projects:
  # Add your projects here
  # my-project:
  #   path: "/home/user/projects/my-project"
  #   description: "My project description"
  #   default: true
  #   allowed_tools:
  #     - "Read"
  #     - "Write"
  #     - "Edit"
  #     - "Bash(git *)"
  #     - "Bash(go *)"
  #     - "Bash(make *)"
  #   max_concurrent_tasks: 1
  #   git:
  #     auto_branch: true
  #     auto_stash: true
  #     auto_commit: true
  #     branch_prefix: "herald/"

rate_limit:
  requests_per_minute: 60
  burst: 10

dashboard:
  enabled: true
