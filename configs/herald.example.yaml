# Herald Configuration
# Copy to ~/.config/herald/herald.yaml and adjust values.

server:
  # Herald listens on localhost only — use Traefik for external access
  host: "127.0.0.1"
  port: 8420
  # Public URL (used for OAuth redirects)
  public_url: "https://herald.example.com"
  # Log level: debug, info, warn, error
  log_level: "info"
  # Optional log file (in addition to stdout)
  # log_file: "~/.config/herald/herald.log"

auth:
  # OAuth 2.1 for Claude Chat Custom Connector
  client_id: "herald-claude-chat"
  # Client secret is auto-generated and stored in ~/.config/herald/secret
  # To override, set HERALD_CLIENT_SECRET env var or uncomment:
  # client_secret: "${HERALD_CLIENT_SECRET}"
  access_token_ttl: 1h
  refresh_token_ttl: 720h
  # Allowed redirect URIs (exact match, no wildcards)
  redirect_uris:
    - "https://claude.ai/oauth/callback"
    - "https://claude.ai/api/oauth/callback"

database:
  path: "~/.config/herald/herald.db"
  retention_days: 90

execution:
  # Path to the Claude Code CLI binary
  claude_path: "claude"
  # Model for task execution (default: sonnet, cheaper for implementation)
  model: "claude-sonnet-4-5-20250929"
  # Default task timeout (override per task)
  default_timeout: 30m
  max_timeout: 2h
  # Working directory for temp files (prompts, outputs)
  work_dir: "~/.config/herald/work"
  # Global concurrent task limit
  max_concurrent: 3
  # Maximum prompt size in bytes (protects against OOM)
  max_prompt_size: 102400
  # Maximum output buffer per task in bytes (protects against OOM)
  max_output_size: 1048576
  env:
    CLAUDE_CODE_ENTRYPOINT: "herald"
    CLAUDE_CODE_DISABLE_AUTO_UPDATE: "1"

projects:
  # Add your projects here
  # my-project:
  #   path: "/home/user/projects/my-project"
  #   description: "My project description"
  #   default: true
  #   allowed_tools:
  #     - "Read"
  #     - "Write"
  #     - "Edit"
  #     - "Bash(git *)"
  #     - "Bash(go *)"
  #     - "Bash(make *)"
  #   max_concurrent_tasks: 1
  #   git:
  #     auto_branch: true
  #     auto_stash: true
  #     auto_commit: true
  #     branch_prefix: "herald/"

rate_limit:
  requests_per_minute: 60
  burst: 10

# Optional: ngrok tunnel for instant HTTPS exposure (no Traefik/Caddy needed)
# Disabled by default — requires ngrok account (free or paid)
# tunnel:
#   enabled: true
#   provider: "ngrok"  # only "ngrok" supported for now
#   # Auth token from https://dashboard.ngrok.com/get-started/your-authtoken
#   # Set via env var HERALD_NGROK_AUTHTOKEN or uncomment:
#   # authtoken: "2abc..."
#   # Optional: fixed domain (paid plans only)
#   # domain: "my-herald.ngrok-free.app"
